import{f as e,e as o,t as l}from"./tree.9e4d3f05.js";import{cs as a,s as t,l as n,bi as s}from"./index.f1ca6476.js";const c=a(),{t:i}=n(),r=e=>{const o=t({searchSchema:[],tableColumns:[],formSchema:[],detailSchema:[]}),l=d(e,o);o.searchSchema=l||[];const a=m(e);o.tableColumns=a||[];const n=h(e);o.formSchema=n;const s=f(e);return o.detailSchema=s,{allSchemas:o}},d=(e,l)=>{const a=[],t=[];o(e,(e=>{var o;if(null==(o=null==e?void 0:e.search)?void 0:o.show){const o={component:e.search.component||"Input",componentProps:{},...e.search,field:e.field,label:e.label};if(o.dictName){const e=c.getDictObj[o.dictName];o.componentProps.options=p(e)}else o.api&&t.push((async()=>{var e;const a=await o.api();if(a){const t=s(l.searchSchema,(e=>e.field===o.field));-1!==t&&(l.searchSchema[t].componentProps.options=p(a.data,null==(e=o.componentProps.optionsAlias)?void 0:e.labelField))}}));delete o.show,delete o.dictName,a.push(o)}}));for(const o of t)o();return a},m=o=>{const a=l(o,{conversion:e=>{var o;if(!1!==(null==(o=null==e?void 0:e.table)?void 0:o.show))return{...e.table,...e}}});return e(a,(e=>(void 0===e.children&&delete e.children,!!e.field)))},h=e=>{const l=[];return o(e,(e=>{var o;if(!1!==(null==(o=null==e?void 0:e.form)?void 0:o.show)){const o={component:e.form&&e.form.component||"Input",...e.form,field:e.field,label:e.label};delete o.show,l.push(o)}})),l},f=e=>{const l=[];return o(e,(e=>{var o;if(!1!==(null==(o=null==e?void 0:e.detail)?void 0:o.show)){const o={...e.detail,field:e.field,label:e.label};delete o.show,l.push(o)}})),l},p=(e,o)=>e.map((e=>(o?e.labelField=i(e.labelField):e.label=i(e.label),e)));export{r as u};
