import{F as e}from"./Form.bbfd6fad.js";import{d as o,b as s,m as a,u as r,q as t,l as i,s as l,r as n,v as d,x as c,o as p,k as m,w as u,e as f,t as g,a as w,g as b,y as j}from"./index.23cec3b4.js";import{E as v}from"./el-button.e5ca07de.js";import{E as h}from"./tsxHelper.9b943d36.js";import{E as y}from"./el-link.e191da46.js";import{u as x}from"./useForm.b78652d4.js";import{l as P,g as R,a as _}from"./index.941f30c0.js";import{u as I}from"./useValidator.d67e0e34.js";import{_ as k}from"./plugin-vue_export-helper.21dcd24c.js";import"./el-col.6e2d0468.js";import"./typescript2.0a085a7f.js";import"./el-popper.314ed8a7.js";import"./index2.710268bd.js";import"./el-input.7364d514.js";import"./event2.c09267d7.js";import"./index2.890f85c7.js";import"./el-tag.365c805e.js";import"./el-input-number.b18a4f5e.js";import"./index2.5ceead26.js";import"./el-switch.0593e0cc.js";import"./validator2.a811c7fc.js";import"./el-divider.4dda1429.js";import"./InputPassword.34b74344.js";import"./Editor.69d4697d.js";import"./debounce.59bf77c9.js";import"./aria2.dceaa135.js";import"./scroll2.020cc849.js";import"./browser2.3783bf08.js";const F={class:"text-2xl font-bold text-center w-[100%]"},z={class:"flex justify-between items-center w-[100%]"},E={class:"w-[100%]"},q={class:"w-[100%] mt-15px"},C={class:"flex justify-between w-[100%]"};var V=k(o({__name:"LoginForm",emits:["to-register"],setup(o,{emit:k}){const{required:V}=I(),D=s(),A=a(),{currentRoute:L,addRoute:U,push:H}=r(),{wsCache:N}=t(),{t:B}=i(),G={username:[V()],password:[V()]},J=l([{field:"title",colProps:{span:24}},{field:"username",label:B("login.username"),value:"admin",component:"Input",colProps:{span:24},componentProps:{placeholder:B("login.usernamePlaceholder")}},{field:"password",label:B("login.password"),value:"admin",component:"InputPassword",colProps:{span:24},componentProps:{style:{width:"100%"},placeholder:B("login.passwordPlaceholder")}},{field:"tool",colProps:{span:24}},{field:"login",colProps:{span:24}},{field:"other",component:"Divider",label:B("login.otherLogin"),componentProps:{contentPosition:"center"}},{field:"otherIcon",colProps:{span:24}}]),K=n(!1),{register:M,elFormRef:O,methods:Q}=x(),S=n(!1),T="#999",W=n("");d((()=>L.value),(e=>{var o;W.value=null==(o=null==e?void 0:e.query)?void 0:o.redirect}),{immediate:!0});const X=async()=>{const e=w(O);await(null==e?void 0:e.validate((async e=>{if(e){S.value=!0;const{getFormData:e}=Q,o=await e();try{const e=await P(o);e&&(N.set(D.getUserInfo,e.data),Y())}finally{S.value=!1}}})))},Y=async()=>{const{getFormData:e}=Q,o=await e(),s={roleName:o.username},a="admin"===o.username?await R(s):await _(s);if(a){const{wsCache:e}=t(),s=a.data||[];e.set("roleRouters",s),"admin"===o.username?await A.generateRoutes("admin",s).catch((()=>{})):await A.generateRoutes("test",s).catch((()=>{})),A.getAddRouters.forEach((e=>{U(e)})),A.setIsAddRouters(!0),H({path:W.value||A.addRouters[0].path})}},Z=()=>{k("to-register")};return(o,s)=>{const a=c("Icon");return p(),m(w(e),{schema:J,rules:G,"label-position":"top","hide-required-asterisk":"",size:"large",class:"dark:border-1 dark:border-[var(--el-border-color)] dark:border-solid",onRegister:w(M)},{title:u((()=>[f("h2",F,g(w(B)("login.login")),1)])),tool:u((()=>[f("div",z,[b(w(h),{modelValue:K.value,"onUpdate:modelValue":s[0]||(s[0]=e=>K.value=e),label:w(B)("login.remember"),size:"small"},null,8,["modelValue","label"]),b(w(y),{type:"primary",underline:!1},{default:u((()=>[j(g(w(B)("login.forgetPassword")),1)])),_:1})])])),login:u((()=>[f("div",E,[b(w(v),{loading:S.value,type:"primary",class:"w-[100%]",onClick:X},{default:u((()=>[j(g(w(B)("login.login")),1)])),_:1},8,["loading"])]),f("div",q,[b(w(v),{class:"w-[100%]",onClick:Z},{default:u((()=>[j(g(w(B)("login.register")),1)])),_:1})])])),otherIcon:u((()=>[f("div",C,[b(a,{icon:"ant-design:github-filled",size:30,class:"cursor-pointer anticon",color:T}),b(a,{icon:"ant-design:wechat-filled",size:30,class:"cursor-pointer anticon",color:T}),b(a,{icon:"ant-design:alipay-circle-filled",size:30,color:T,class:"cursor-pointer anticon"}),b(a,{icon:"ant-design:weibo-circle-filled",size:30,color:T,class:"cursor-pointer anticon"})])])),_:1},8,["schema","onRegister"])}}}),[["__scopeId","data-v-516888a6"]]);export{V as default};
